{% block seo_route_widget %}
    {{ form_widget(form) }}

    <script type="text/javascript">
        (function(){
            let select = document.getElementById('{{ form.name.vars.id }}');
            let params = document.getElementById('{{ form.params.vars.id }}');
            let prototype = params.dataset.prototype;

            select.addEventListener('change', onChange);

            function onChange() {
                let selectedOption = select.options[select.selectedIndex];
                let _params = JSON.parse(selectedOption.dataset.params);

                params.innerHTML = '';
                for(let key in _params) {
                    addParam(key, _params[key]);
                }

                params.parentNode.parentNode.style.display = _params.length === 0 ? 'none' : 'block';
            }

            function addParam(name, value) {
                let param = prototype
                    .replace(/\>__name__label__\</g, '>' + name + '<')
                    .replace(/_params___name__/g, '_params_' + name)
                    .replace(/params\]\[__name__\]/g, 'params][' + name + ']');

                params.innerHTML += param;
            }
        })();
    </script>
{% endblock %}
